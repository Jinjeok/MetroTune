/* --- 기본 및 페이지 레이아웃 --- */
html, body {
    height: 100%;
    margin: 0;
    padding: 20px;
    box-sizing: border-box;
    background-color: #f0f0f0;
    font-family: sans-serif;
}

/* --- 상단 글로벌 컨트롤 컨테이너 --- */
.global-controls-container {
    display: flex;
    flex-direction: column;
    gap: 15px;
    width: 100%;
    max-width: 450px;
    margin: 0 auto 20px auto;
    background-color: white;
    padding: 15px 20px;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    box-sizing: border-box;
}
.volume-control-wrapper { display: flex; align-items: center; gap: 10px; width: 100%; }
.volume-control-wrapper input { width: 100%; }
.volume-control-wrapper span { font-weight: bold; font-size: 0.9em; white-space: nowrap; min-width: 55px; text-align: left; }
    
/* --- 메인 앱 컨테이너 (레이아웃의 핵심) --- */
.app-container {
    display: grid;
    grid-template-columns: 1fr auto 1fr; /* 3열 그리드 */
    align-items: start; /* 상단 정렬 */
    gap: 20px;
    width: 100%;
}

/* --- 메트로놈 모듈 공통 스타일 --- */
.metronome {
    width: 350px;
    background-color: white;
    padding: 20px 25px;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    text-align: center;
    box-sizing: border-box;
    transition: opacity 0.3s, visibility 0.3s, transform 0.3s;
    
    /* ▼▼▼ 푸터를 아래에 고정하기 위해 flexbox 속성 추가 ▼▼▼ */
    display: flex;
    flex-direction: column;
}
.metronome h1, .metronome h2 { color: #333; margin-top: 0; }

/* ▼▼▼ 핵심 해결책: .hidden 클래스 변경 ▼▼▼ */
.chord-module.hidden, .rhythm-module.hidden {
    opacity: 0; /* 투명하게 만듦 */
    visibility: hidden; /* 보이지 않고, 클릭도 안되게 함 */
    transform: scale(0.95); /* 살짝 작아지는 효과 */
    pointer-events: none; /* 마우스 이벤트 무시 */
}

/* --- 모듈 위치 지정 --- */
.rhythm-module { grid-column: 1; justify-self: end; }
.main-metronome { grid-column: 2; }
.chord-module { grid-column: 3; justify-self: start; }

/* --- 나머지 UI 요소들 (이전과 동일) --- */
.bpm-presets {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin-bottom: 15px;
}

.preset-btn {
    background-color: #f0f0f0;
    border: 1px solid #ddd;
    border-radius: 5px;
    padding: 5px 12px;
    font-size: 0.9em;
    font-weight: bold;
    color: #555;
    cursor: pointer;
    transition: all 0.1s;
}

.preset-btn:hover {
    background-color: #e0e0e0;
    border-color: #ccc;
}

.preset-btn.active {
    background-color: #4CAF50;
    color: white;
    border-color: #4CAF50;
}
.bpm-controls { display: flex; justify-content: center; align-items: center; gap: 15px; margin: 20px 0; }
.bpm-display { font-size: 2em; white-space: nowrap; }
.bpm-btn { width: 45px; height: 45px; font-size: 1.8em; font-weight: bold; color: white; background-color: #4CAF50; border: none; border-radius: 10px; cursor: pointer; display: inline-flex; justify-content: center; align-items: center; line-height: 1; transition: all 0.1s; }
.bpm-btn:hover { background-color: #45a049; }
.bpm-btn:active { background-color: #3e8e41; transform: scale(0.95); }
.bpm-slider input { width: 100%; }
.time-signature { margin-top: 20px; font-size: 1em; }
.time-signature input { width: 50px; font-size: 1em; text-align: center; margin-left: 10px; }
#beat-indicator-container { display: flex; justify-content: center; gap: 10px; margin-top: 20px; height: 24px; }
.beat-dot { width: 20px; height: 20px; border-radius: 50%; background-color: #e0e0e0; transition: all 0.1s ease-in-out; }
.beat-dot.state-accent { background-color: #4CAF50; }
.beat-dot.state-tick { background-color: #2196F3; }
.beat-dot.state-silent { background-color: #cccccc; }
.beat-dot.active { transform: scale(1.2); box-shadow: 0 0 10px rgba(0,0,0,0.5); }
#chord-display { font-size: 4em; font-weight: bold; color: #333; height: 100px; display: flex; justify-content: center; align-items: center; margin-top: 20px;}
.chord-input-area { display: flex; align-items: center; gap: 10px; margin-top: 10px; }
#chord-input { flex-grow: 1; width: auto; padding: 10px; border: 1px solid #ccc; border-radius: 5px; font-family: sans-serif; font-size: 1em; resize: vertical; }
.random-chord-toggle { display: flex; align-items: center; gap: 5px; flex-shrink: 0; }
.rhythm-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin: 20px 0; }
.rhythm-cell { width: 100%; padding-top: 100%; position: relative; background-color: #e0e0e0; border-radius: 5px; transition: all 0.1s; cursor: pointer; }
.rhythm-cell:hover { background-color: #d0d0d0; transform: scale(1.05); }
.rhythm-cell.active { background-color: #ff9800; }
.rhythm-cell.accent { background-color: #f44336; transform: scale(1.05); }
.rhythm-cell.playing { transform: scale(1.1); box-shadow: 0 0 10px #ff9800; }
.rhythm-controls { display: flex; justify-content: center; align-items: center; gap: 20px; margin-top: 10px; }
.random-rhythm-toggle, .rhythm-accent-toggle { display: flex; align-items: center; gap: 5px; }
#random-rhythm-checkbox, #rhythm-accent-checkbox { width: 18px; height: 18px; cursor: pointer; }
.random-rhythm-toggle label, .rhythm-accent-toggle label { font-size: 1.2em; cursor: pointer; user-select: none; }
#start-stop-btn { background-color: #4CAF50; color: white; border: none; padding: 15px 0; text-align: center; width: 100%; font-size: 16px; margin-top: 20px; cursor: pointer; border-radius: 5px; }
.module-toggles { display: flex; gap: 10px; margin-top: 10px; }
#toggle-rhythm-panel-btn, #toggle-chord-panel-btn { flex: 1; background-color: #555; color: white; border: none; padding: 12px 0; text-align: center; font-size: 16px; cursor: pointer; border-radius: 5px; transition: opacity 0.1s; }
#start-stop-btn:hover, #toggle-rhythm-panel-btn:hover, #toggle-chord-panel-btn:hover { opacity: 0.9; }

.chord-module-footer, .rhythm-module-footer {
    margin-top: auto; /* 가장 중요한 속성: 푸터를 맨 아래로 밀어냄 */
    padding-top: 20px;
    font-size: 0.7em;
    color: #888;
}
@media (max-width: 1100px) {
    .app-container {
        grid-template-columns: 1fr; /* 3열 그리드를 1열로 변경 */
        justify-items: center;      /* 아이템들을 가운데 정렬 */
        align-items: center;
    }

    /* 각 모듈이 항상 1열을 차지하도록 명시 */
    .rhythm-module,
    .main-metronome,
    .chord-module {
        grid-column: 1;
        justify-self: auto; /* PC에서의 정렬 방식 초기화 */
    }

    /* 모바일에서 너무 커지지 않도록 최대 너비 설정 */
    .metronome {
        width: 100%;
        max-width: 450px;
    }
}